<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Glow Girl - Catálogo</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/catalog.css">
    <link rel="icon" type="image/png" href="/img/icons/logo_head_icon.png">
</head>

<body>
    <header>
        <!-- Navbar -->
        <nav class="navbar">
            <div class="logo">
                <a href = "/api/admin/catalog">
                    <img id="storeLogo" src="http://localhost:5000/img/icons/logo_tienda_light_icon.png" alt="Store Logo">
                </a>
            </div>

            <!-- FALTA ARREGLAR EL FILTRO -->
            <div class="btn-container">
                <a href="/api/admin/products/create">
                    <button class="btn-darkPink" id="btnCrearProducto">Crear producto</button>
                </a>
                <a href="/api/admin/sales">
                    <button class="btn-darkPink" id="btnVentas">Ver ventas</button>
                </a>
            </div>

            <div class="icons">
                <div class="user">
                    <img src="http://localhost:5000/img/icons/user_icon.png" alt="User" class="icon" id="userIcon">
                    <div id="userWindow" class="user-window hidden">
                        <p id="userName">Nombre</p>
                        <button class="btn-grey" id="logOut">Cerrar sesión</button>
                    </div>
                </div>
                <img src="http://localhost:5000/img/icons/light_mode_icon.png" alt="Change Mode" id="btnMode"
                    class="icon-mode">
            </div>
        </nav>
    </header>

    <main>
        <h2>✩ CATEGORÍAS ✩</h2>
        <div class="div-categories">
            <form method="GET" action="">
                <% if (category==='bag' ) { %>
                    <!-- Si ya está seleccionada, enviá sin category -->
                    <button type="submit" class="category selected">
                        <img src="/img/others/acceso_carteras.jpg" alt="Bags" class="btn-category">
                    </button>
                    <% } else { %>
                        <!-- Si no está seleccionada, aplicá el filtro -->
                        <input type="hidden" name="category" value="bag">
                        <button type="submit" class="category">
                            <img src="/img/others/acceso_carteras.jpg" alt="Bags" class="btn-category">
                        </button>
                        <% } %>
            </form>

            <form method="GET" action="">
                <% if (category==='accessory' ) { %>
                    <button type="submit" class="category selected">
                        <img src="/img/others/acceso_accesorios.jpg" alt="Accessories" class="btn-category">
                    </button>
                    <% } else { %>
                        <input type="hidden" name="category" value="accessory">
                        <button type="submit" class="category">
                            <img src="/img/others/acceso_accesorios.jpg" alt="Accessories" class="btn-category">
                        </button>
                        <% } %>
            </form>
        </div>
        <section class="products-section">
            <h2>*ੈ✩‧₊˚NUESTROS PRODUCTOS*ੈ✩‧₊˚</h2>
            <div class="product-grid">
                <% products.forEach(product=> { %>
                    <div class="product-card">
                        <img src="/img/products/<%= product.img %>" alt="<%= product.name %>">
                        <h3>
                            <%= product.name %>
                        </h3>
                        <p>
                            <%=product.description %>
                        </p>
                        <div class="bottom-container">
                            <strong>$<%= product.price.toLocaleString("es-AR") %></strong>
                            <a href="/api/admin/products/update/<%=product.id%>">
                                <button class="btn-grey" id="btnEdit">Editar</button>
                            </a>
                            <button class="btn-red" id="btnDeactivate" data-id="<%= product.id %>" type="button">
                                <%= product.active ? 'Desactivar' : 'Activar' %>
                            </button>
                        </div>
                    </div>
                    <% }) %>
            </div>
        </section>
        <div class="pagination">
            <% if (currentPage> 1) { %>
                <form method="GET" action="">
                    <input type="hidden" name="page" value="<%= currentPage - 1 %>">
                    <% if (category) { %>
                        <input type="hidden" name="category" value="<%= category %>">
                        <% } %>
                            <button type="submit">Anterior</button>
                </form>
                <% } %>

                    <% for (let i=1; i <=totalPages; i++) { %>
                        <form method="GET" action="">
                            <input type="hidden" name="page" value="<%= i %>">
                            <% if (category) { %>
                                <input type="hidden" name="category" value="<%= category %>">
                                <% } %>
                                    <button type="submit" class="<%= currentPage === i ? 'pagina-actual' : '' %>"
                                        <%=currentPage===i ? 'disabled' : '' %>>
                                        <%= i %>
                                    </button>
                        </form>
                        <% } %>

                            <% if (currentPage < totalPages) { %>
                                <form method="GET" action="">
                                    <input type="hidden" name="page" value="<%= currentPage + 1 %>">
                                    <% if (category) { %>
                                        <input type="hidden" name="category" value="<%= category %>">
                                        <% } %>
                                            <button type="submit">Siguiente</button>
                                </form>
                                <% } %>
        </div>
    </main>

    <%- include('partials/footer.ejs') %>

        <script type="module" src="/js/catalog.js"></script>
</body>

</html>